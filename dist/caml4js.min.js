"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Operator=function(e,t){this.internalName=t,this.type=e},FieldOperator=function(n){function e(e,t){return n.call(this,e,t)||this}return __extends(e,n),e.prototype.isTrue=function(){return'<Eq>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">1</Value>\n          </Eq>'},e.prototype.isFalse=function(){return'<Eq>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">1</Value>\n          </Eq>'},e.prototype.equalTo=function(e){return e instanceof Date&&(e=e.toISOString()),'<Eq>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Eq>"},e.prototype.notEqualTo=function(e){return e instanceof Date&&(e=e.toISOString()),'<Neq>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Neq>"},e.prototype.greaterThan=function(e){return e instanceof Date&&(e=e.toISOString()),'<Gt>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Gt>"},e.prototype.lessThan=function(e){return e instanceof Date&&(e=e.toISOString()),'<Lt>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Lt>"},e.prototype.greaterThanOrEqualTo=function(e){return e instanceof Date&&(e=e.toISOString()),'<Geq>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Get>"},e.prototype.lessThanOrEqualTo=function(e){return e instanceof Date&&(e=e.toISOString()),'<Leq>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Leq>"},e.prototype.isNull=function(){return'<IsNull>\n            <FieldRef Name="'+this.internalName+'" />\n          </IsNull>'},e.prototype.isNotNull=function(){return'<IsNotNull>\n            <FieldRef Name="'+this.internalName+'" />\n          </IsNotNull>'},e.prototype.beginsWith=function(e){return'<BeginsWith>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </BeginsWith>"},e.prototype.in=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n='<In><FieldRef Name="'+this.internalName+'" /><Values>',r=0;r<e.length;r++){var o=e[r];o instanceof Date&&(o=o.toISOString()),n+='<Value Type="'+this.type+'">'+o+"</Value>"}return n+"</Values>"},e.prototype.contains=function(e){return'<Contains>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Contains>"},e.prototype.notIncludes=function(e){return'<NotIncludes>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </NotIncludes>"},e.prototype.includes=function(e){return'<Includes>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Includes>"},e.NOW="<Now />",e}(exports.Operator=Operator);exports.FieldOperator=FieldOperator;var LookupFieldOperator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.idEqualTo=function(e){return'<Eq>\n            <FieldRef Name="'+this.internalName+'" LookupId="TRUE"/>\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Eq>"},t.prototype.valueEqualTo=function(e){return'<Eq>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+this.type+'">'+e+"</Value>\n          </Eq>"},t.prototype.idIn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n='<In><FieldRef LookupId="True" Name="'+this.internalName+'" /><Values>',r=0;r<e.length;r++)n+='<Value Type="'+this.type+'">'+e[r]+"</Value>";return n+"</Values>"},t.prototype.includes=function(e){return'<Eq>\n            <FieldRef Name="'+this.internalName+'" LookupId="TRUE"/>\n            <Value Type="'+ValueType.LookupMulti+'">'+e+"</Value>\n          </Eq>"},t}(Operator);exports.LookupFieldOperator=LookupFieldOperator;var JoinType,UserFieldOperator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.equalToCurrentUser=function(){return'<Eq>\n            <FieldRef Name="'+this.internalName+'" LookupId="TRUE"/>\n            <Value Type="'+ValueType.Integer+'"><UserID /></Value>\n          </Eq>'},t.prototype.isInSPGroup=function(){return this.memberOf(ValueType.SPGroup)},t.prototype.isInSPWebGroups=function(){return this.memberOf(ValueType.SPWebGroups)},t.prototype.isInSPWebAllUsers=function(){return this.memberOf(ValueType.SPWebAllUsers)},t.prototype.isInSPWebUsers=function(){return this.memberOf(ValueType.SPWebUsers)},t.prototype.isInCurrentUserGroups=function(){return this.memberOf(ValueType.CurrentUserGroups)},t.prototype.includes=function(e){return'<Eq>\n            <FieldRef Name="'+this.internalName+'" />\n            <Value Type="'+ValueType.UserMulti+'">'+e+"</Value>\n          </Eq>"},t.prototype.memberOf=function(e){return'<Membership Type="'+e+'">\n            <FieldRef Name="'+this.internalName+'" />\n          </Membership>'},t}(Operator);exports.UserFieldOperator=UserFieldOperator,function(e){e.LEFT="LEFT",e.INNER="INNER"}(JoinType=exports.JoinType||(exports.JoinType={}));var FieldType,ValueType,Join=function(){function e(e){this.pJoinName="",this.projections=[],Object.assign(this,e)}return e.prototype.getJoinElement=function(){var e=this.pJoinName?'List="'+this.pJoinName+'"':"";return"<Join Type='"+this.type+"' ListAlias='"+this.joinName+"'>\n            <Eq>\n                <FieldRef Name='"+this.pkey+"' RefType='Id' "+e+"/>\n                <FieldRef List='"+this.joinName+"' Name='ID'/>\n            </Eq>\n        </Join>"},e.prototype.getProjectionsElement=function(){var n=this.joinName;return this.projections.reduce(function(e,t){return e+"<Field \n                Name='"+t.Name+"'\n                Type='"+t.Type+"'\n                List='"+n+"'\n                ShowField='"+t.ShowField+"'/>"},"")},e}();exports.Join=Join,function(e){e.LookUp="Lookup",e.DateTime="DateTime",e.Choice="Choice",e.Computed="Computed",e.URL="URL",e.Integer="Integer",e.Text="Text",e.Date="Date",e.Note="Note"}(FieldType=exports.FieldType||(exports.FieldType={})),function(e){e.Integer="Integer",e.Text="Text",e.Date="Date",e.Note="Note",e.SPWebAllUsers="SPWeb.AllUsers",e.SPGroup="SPGroup",e.SPWebGroups="SPWeb.Groups",e.CurrentUserGroups="CurrentUserGroups",e.SPWebUsers="SPWeb.Users",e.LookUp="Lookup",e.DateTime="DateTime",e.Choice="Choice",e.Computed="Computed",e.URL="URL",e.LookupMulti="LookupMulti",e.UserMulti="UserMulti"}(ValueType=ValueType||{}),exports.and=function(e,t){return"<And>"+e+t+"</And>"},exports.or=function(e,t){return"<Or>"+e+t+"</Or>"},exports.where=function(e){return"<Where>"+e+"</Where>"},exports.join=function(e,t,n,r,o){return void 0===r&&(r=""),void 0===o&&(o=[]),new Join({type:e,joinName:t,pkey:n,projections:o,pJoinName:r})},exports.joins=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"<Joins>"+e.reduce(function(e,t){return e+t.getJoinElement()},"")+"</Joins><ProjectedFields>"+e.reduce(function(e,t){return e+t.getProjectionsElement()},"")+"</ProjectedFields>"},exports.viewFields=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"<ViewFields>"+e.reduce(function(e,t){return e+'<FieldRef Name="'+t+'" />'},"")+"</ViewFields>"},exports.query=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"<View>"+e.reduce(function(e,t){return e+t},"")+"</View>"},exports.orderBy=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"<OrderBy>"+e.reduce(function(e,t){var n=t.DSC?'Ascending="FALSE"':"";return e+'<FieldRef Name="'+t.Field+'" '+n+"/>"},"")+"</OrderBy>"},exports.groupBy=function(e){return'<GroupBy><FieldRef Name="'+e+'" /></GroupBy>'},exports.noteField=function(e){return new FieldOperator(ValueType.Note,e)},exports.choiceField=function(e){return new FieldOperator(ValueType.Choice,e)},exports.computedField=function(e){return new FieldOperator(ValueType.Computed,e)},exports.urlField=function(e){return new FieldOperator(ValueType.URL,e)},exports.numberField=function(e){return new FieldOperator(ValueType.Integer,e)},exports.textField=function(e){return new FieldOperator(ValueType.Text,e)},exports.dateField=function(e){return new FieldOperator(ValueType.Date,e)},exports.booleanField=function(e){return new FieldOperator(ValueType.Integer,e)},exports.dateTimeField=function(e){return new FieldOperator(ValueType.DateTime,e)},exports.lookupField=function(e){return new LookupFieldOperator(ValueType.Integer,e)},exports.userField=function(e){return new UserFieldOperator(ValueType.CurrentUserGroups,e)};