"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Operator=function(e,t){this.internalName=t,this.type=e},FieldOperator=function(n){function e(e,t){return n.call(this,e,t)||this}return __extends(e,n),e.prototype.isTrue=function(){return"<Eq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>1</Value>\n          </Eq>"},e.prototype.isFalse=function(){return"<Eq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>1</Value>\n          </Eq>"},e.prototype.equalTo=function(e){return"<Eq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </Eq>"},e.prototype.notEqualTo=function(e){return"<Neq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </Neq>"},e.prototype.greaterThan=function(e){return"<Gt>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </Gt>"},e.prototype.lessThan=function(e){return"<Lt>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </Lt>"},e.prototype.greaterThanOrEqualTo=function(e){return"<Geq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </Get>"},e.prototype.lessThanOrEqualTo=function(e){return"<Leq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </Leq>"},e.prototype.isNull=function(){return"<IsNull>\n            <FieldRef Name='"+this.internalName+"'/>\n          </IsNull>"},e.prototype.isNotNull=function(){return"<IsNotNull>\n            <FieldRef Name='"+this.internalName+"'/>\n          </IsNotNull>"},e.prototype.beginsWith=function(e){return"<BeginsWith>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </BeginsWith>"},e.prototype.in=function(e){for(var t="<In><FieldRef Name='"+this.internalName+"' /><Values>",n=0;n<e.length;n++)t+="<Value Type='"+this.type+"'>"+e[n]+"</Value>";return t+"</Values></In>"},e.prototype.contains=function(e){return"<Contains>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </Contains>"},e.prototype.notIncludes=function(e){return"<NotIncludes>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </NotIncludes>"},e.prototype.includes=function(e){return"<Includes>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </Includes>"},e}(exports.Operator=Operator);exports.FieldOperator=FieldOperator;var DateFieldOperator=function(n){function e(e,t){return n.call(this,e,t)||this}return __extends(e,n),e.prototype.equalTo=function(e){var t="";return this.type==ValueType.DateTime&&(t=" IncludeTimeValue='TRUE'"),"<Eq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+ValueType.DateTime+"'"+t+">"+e+"</Value>\n          </Eq>"},e.prototype.notEqualTo=function(e){var t="";return this.type==ValueType.DateTime&&(t=" IncludeTimeValue='TRUE'"),"<Neq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'"+t+">"+e+"</Value>\n          </Neq>"},e.prototype.greaterThan=function(e){var t="";return this.type==ValueType.DateTime&&(t=" IncludeTimeValue='TRUE'"),"<Gt>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'"+t+">"+e+"</Value>\n          </Gt>"},e.prototype.lessThan=function(e){var t="";return this.type==ValueType.DateTime&&(t=" IncludeTimeValue='TRUE'"),"<Lt>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'"+t+">"+e+"</Value>\n          </Lt>"},e.prototype.greaterThanOrEqualTo=function(e){var t="";return this.type==ValueType.DateTime&&(t=" IncludeTimeValue='TRUE'"),"<Geq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'"+t+">"+e+"</Value>\n          </Get>"},e.prototype.lessThanOrEqualTo=function(e){var t="";return this.type==ValueType.DateTime&&(t=" IncludeTimeValue='TRUE'"),"<Leq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'"+t+">"+e+"</Value>\n          </Leq>"},e.prototype.isNull=function(){return"<IsNull>\n            <FieldRef Name='"+this.internalName+"'/>\n          </IsNull>"},e.prototype.isNotNull=function(){return"<IsNotNull>\n            <FieldRef Name='"+this.internalName+"'/>\n          </IsNotNull>"},e.prototype.in=function(e){var t="";this.type==ValueType.DateTime&&(t=" IncludeTimeValue='TRUE'");for(var n="<In><FieldRef Name='"+this.internalName+"' /><Values>",r=0;r<e.length;r++)n+="<Value Type='"+this.type+"'"+t+">"+e[r]+"</Value>";return n+"</Values></In>"},e}(Operator);exports.DateFieldOperator=DateFieldOperator;var LookupFieldOperator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.idEqualTo=function(e){return"<Eq>\n            <FieldRef Name='"+this.internalName+"' LookupId='TRUE'/>\n            <Value Type='Integer'>"+e+"</Value>\n          </Eq>"},t.prototype.valueEqualTo=function(e){return"<Eq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+this.type+"'>"+e+"</Value>\n          </Eq>"},t.prototype.idIn=function(e){for(var t="<In><FieldRef LookupId='True' Name='"+this.internalName+"'/><Values>",n=0;n<e.length;n++)t+="<Value Type='"+this.type+"'>"+e[n]+"</Value>";return t+"</Values></In>"},t.prototype.includes=function(e){return"<Eq>\n            <FieldRef Name='"+this.internalName+"' LookupId='TRUE'/>\n            <Value Type='"+ValueType.LookupMulti+"'>"+e+"</Value>\n          </Eq>"},t}(Operator);exports.LookupFieldOperator=LookupFieldOperator;var JoinType,UserFieldOperator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.idEqualTo=function(e){return"<Eq>\n            <FieldRef Name='"+this.internalName+"' LookupId='TRUE'/>\n            <Value Type='"+ValueType.Integer+"'>"+e+"</Value>\n          </Eq>"},t.prototype.displayNameEqualTo=function(e){return"<Eq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+ValueType.Text+"'>"+e+"</Value>\n          </Eq>"},t.prototype.equalToCurrentUser=function(){return"<Eq>\n            <FieldRef Name='"+this.internalName+"' LookupId='TRUE'/>\n            <Value Type='"+ValueType.Integer+"'><UserID/></Value>\n          </Eq>"},t.prototype.isInSPGroup=function(e){return"<Membership Type='"+ValueType.SPGroup+"' ID='"+e+"'>\n            <FieldRef Name='"+this.internalName+"'/>\n        </Membership>"},t.prototype.isInSPWebGroups=function(){return this.memberOf(ValueType.SPWebGroups)},t.prototype.isInSPWebAllUsers=function(){return this.memberOf(ValueType.SPWebAllUsers)},t.prototype.isInSPWebUsers=function(){return this.memberOf(ValueType.SPWebUsers)},t.prototype.isInCurrentUserGroups=function(){return this.memberOf(ValueType.CurrentUserGroups)},t.prototype.includes=function(e){return"<Eq>\n            <FieldRef Name='"+this.internalName+"'/>\n            <Value Type='"+ValueType.UserMulti+"'>"+e+"</Value>\n          </Eq>"},t.prototype.memberOf=function(e){return"<Membership Type='"+e+"'>\n            <FieldRef Name='"+this.internalName+"'/>\n          </Membership>"},t}(Operator);exports.UserFieldOperator=UserFieldOperator,function(e){e.LEFT="LEFT",e.INNER="INNER"}(JoinType=exports.JoinType||(exports.JoinType={}));var FieldType,ValueType,AggregationType,ViewScope,Join=function(){function e(e){this.pJoinName="",this.projections=[],Object.assign(this,e)}return e.prototype.getJoinElement=function(){var e=this.pJoinName?"List='"+this.pJoinName+"'":"";return"<Join Type='"+this.type+"' ListAlias='"+this.joinName+"'>\n            <Eq>\n                <FieldRef Name='"+this.pkey+"' RefType='Id' "+e+"/>\n                <FieldRef Name='ID' List='"+this.joinName+"'/>\n            </Eq>\n        </Join>"},e.prototype.getProjectionsElement=function(){var n=this.joinName;return this.projections.reduce(function(e,t){return e+"<Field Name='"+t.Name+"' Type='"+t.Type+"' List='"+n+"' ShowField='"+t.Field+"'/>"},"")},e}();exports.Join=Join,function(e){e.LookUp="Lookup",e.DateTime="DateTime",e.Choice="Choice",e.Computed="Computed",e.URL="URL",e.Number="Number",e.Text="Text",e.Date="Date",e.Note="Note"}(FieldType=exports.FieldType||(exports.FieldType={})),function(e){e.Integer="Integer",e.Text="Text",e.Date="Date",e.Note="Note",e.SPWebAllUsers="SPWeb.AllUsers",e.SPGroup="SPGroup",e.SPWebGroups="SPWeb.Groups",e.CurrentUserGroups="CurrentUserGroups",e.SPWebUsers="SPWeb.Users",e.LookUp="Lookup",e.DateTime="DateTime",e.Choice="Choice",e.Computed="Computed",e.URL="URL",e.LookupMulti="LookupMulti",e.UserMulti="UserMulti",e.Number="Number"}(ValueType=ValueType||{}),function(e){e.Count="Count",e.Sum="Sum"}(AggregationType=exports.AggregationType||(exports.AggregationType={})),function(e){e.FilesOnly="FilesOnly",e.Recursive="Recursive",e.RecursiveAll="RecursiveAll"}(ViewScope=exports.ViewScope||(exports.ViewScope={})),exports.and=function(e,t){return"<And>"+e+t+"</And>"},exports.or=function(e,t){return"<Or>"+e+t+"</Or>"},exports.where=function(e){return"<Where>"+e+"</Where>"},exports.join=function(e,t,n,r,i){return void 0===r&&(r=""),void 0===i&&(i=[]),new Join({type:e,joinName:t,pkey:n,projections:i,pJoinName:r})},exports.joins=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"<Joins>"+e.reduce(function(e,t){return e+t.getJoinElement()},"")+"</Joins><ProjectedFields>"+e.reduce(function(e,t){return e+t.getProjectionsElement()},"")+"</ProjectedFields>"},exports.viewFields=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"<ViewFields>"+e.reduce(function(e,t){return e+"<FieldRef Name='"+t+"'/>"},"")+"</ViewFields>"},exports.query=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"<Query>"+e.reduce(function(e,t){return e+t},"")+"</Query>"},exports.view=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"<View>"+e.reduce(function(e,t){return e+t},"")+"</View>"},exports.viewRecursive=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return'<View Scope="'+e+'">'+t.reduce(function(e,t){return e+t},"")+"</View>"},exports.orderBy=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"<OrderBy>"+e.reduce(function(e,t){if(t.Field){var n=t.Desc?' Ascending="FALSE"':"";return e+"<FieldRef Name='"+t.Field+"'"+n+"/>"}return e},"")+"</OrderBy>"},exports.groupBy=function(e){return e?"<GroupBy><FieldRef Name='"+e+"'/></GroupBy>":""},exports.aggregations=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return'<Aggregations Value="On">'+e.reduce(function(e,t){return t.Name&&t.Type?e+'<FieldRef Name="'+t.Name+'" Type="'+t.Type+'"/>':e},"")+"</Aggregations>"},exports.rowLimit=function(e,t){return void 0===t&&(t=!1),"<RowLimit"+(t?' Paged="TRUE"':"")+">"+e+"</RowLimit>"},exports.noteField=function(e){return new FieldOperator(ValueType.Note,e)},exports.choiceField=function(e){return new FieldOperator(ValueType.Choice,e)},exports.computedField=function(e){return new FieldOperator(ValueType.Computed,e)},exports.urlField=function(e){return new FieldOperator(ValueType.URL,e)},exports.numberField=function(e){return new FieldOperator(ValueType.Number,e)},exports.textField=function(e){return new FieldOperator(ValueType.Text,e)},exports.dateField=function(e){return new DateFieldOperator(ValueType.Date,e)},exports.booleanField=function(e){return new FieldOperator(ValueType.Integer,e)},exports.dateTimeField=function(e){return new DateFieldOperator(ValueType.DateTime,e)},exports.lookupField=function(e){return new LookupFieldOperator(ValueType.LookUp,e)},exports.userField=function(e){return new UserFieldOperator(ValueType.CurrentUserGroups,e)};